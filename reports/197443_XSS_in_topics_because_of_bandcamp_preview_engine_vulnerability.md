# XSS in topics because of bandcamp preview engine vulnerability

## Report Details
- **Report ID**: 197443
- **URL**: https://hackerone.com/reports/197443
- **State**: Closed
- **Severity**: high
- **Submitted**: 2017-01-11T02:43:37.980Z
- **Disclosed**: 2017-01-20T23:50:12.412Z

## Reporter
- **Username**: skavans
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: discourse

## Vulnerability Information
1. Load http://try.discourse.org
2. Click "New topic"
3. Enter this payload https://89.223.28.48/bandcamp.com/album/index.html?XSSa2 to field with placeholder "Type title or paste a link here"
4. Wait for the preview engine to parse the link
4. XSS will fire

{F151439}

You should sanitize external data in this engine and replace *matches_regexp* from
`^https?:\/\/.*bandcamp\.com\/album\/`
to
`^https?:\/\/.*\.bandcamp\.com\/album\/`
to fix the issue.

## Attachments
- ______________2017-01-11___5.23.20.png
