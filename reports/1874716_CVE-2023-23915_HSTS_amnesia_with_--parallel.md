# CVE-2023-23915: HSTS amnesia with --parallel

## Report Details
- **Report ID**: 1874716
- **URL**: https://hackerone.com/reports/1874716
- **State**: Closed
- **Severity**: low
- **Submitted**: 2023-02-15T09:14:11.769Z
- **Disclosed**: 2023-02-24T20:15:56.444Z

## Reporter
- **Username**: nyymi
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: ibb

## Vulnerability Information
curl's HSTS cache saving behaves wrongly when multiple URLs are requested in parallel.

Using its HSTS support, curl can be instructed to use HTTPS instead of using an insecure clear-text HTTP step even when HTTP is provided in the URL. This HSTS mechanism would however surprisingly fail when multiple transfers are done in parallel as the HSTS cache file gets overwritten by the most recently completed transfer.

A later HTTP-only transfer to the earlier host name would then not get upgraded properly to HSTS.

## Impact

Bypass intended security control.

## Attachments
No attachments
