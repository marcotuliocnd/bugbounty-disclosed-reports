# CVE-2022-45402: Apache Airflow: Open redirect during login

## Report Details
- **Report ID**: 1782514
- **URL**: https://hackerone.com/reports/1782514
- **State**: Closed
- **Severity**: medium
- **Submitted**: 2022-11-23T17:16:45.308Z
- **Disclosed**: 2022-12-01T09:41:24.102Z

## Reporter
- **Username**: bugra
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: ibb

## Vulnerability Information
In Apache Airflow versions prior to 2.4.3, there was an open redirect in the webserver's `/login` endpoint.

my initial email to `security@apache.org`:
```
Hi,

In Apache Airflow, there is a parameter "next" on the Login page. And after a successful login, we're redirected to this parameter's value. 
I see there are some preventions for the open redirect bug. However, I can bypass these preventions using "/\google.com"

It seems this parameter accepts anything after the slash "/" character. And, browsers parse "/\" as "http://" in the location header.

For reproducing, you can try to login on the http://127.0.0.1:8080/login/?next=/\google.com

I tested this bug in the last version (v2.4.2)

Regards,
Bugra Eskici
```

Here is the email thread:
{█████████}

## Impact

Unvalidated URL redirection during login, can be used for phishing, etc.

Regards,
Bugra

## Attachments
No attachments
