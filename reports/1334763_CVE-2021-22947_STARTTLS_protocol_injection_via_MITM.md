# CVE-2021-22947: STARTTLS protocol injection via MITM

## Report Details
- **Report ID**: 1334763
- **URL**: https://hackerone.com/reports/1334763
- **State**: Closed
- **Severity**: medium
- **Submitted**: 2021-09-09T14:00:44.812Z
- **Disclosed**: 2021-09-24T13:14:53.717Z

## Reporter
- **Username**: monnerat
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: curl

## Vulnerability Information
## Summary:
A man-in-the-middle can inject cleartext forged responses to future encrypted commands  by pipelining them to the STARTTLS response.

## Steps To Reproduce:
Use the attached test case within the curl test system. It is based on IMAP FETCH with explicit TLS. Upon test failure, the downloaded file contains "You've been hacked!" rather than the requested mail.

## Impact

Mailbox content forgery (IMAP, POP3).
Sent mail content forgery (SMTP).

## Attachments
- test981
- starttls-pipelining.patch
