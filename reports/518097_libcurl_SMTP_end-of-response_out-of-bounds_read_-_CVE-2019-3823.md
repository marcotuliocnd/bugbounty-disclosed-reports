# libcurl: SMTP end-of-response out-of-bounds read - CVE-2019-3823

## Report Details
- **Report ID**: 518097
- **URL**: https://hackerone.com/reports/518097
- **State**: Closed
- **Severity**: high
- **Submitted**: 2019-03-28T15:41:49.311Z
- **Disclosed**: 2021-01-08T15:07:44.864Z

## Reporter
- **Username**: geeknik
- **Name**: N/A

## Team
- **Name**: N/A
- **Handle**: curl

## Vulnerability Information
```
libcurl contains a heap out-of-bounds read in the code handling the
end-of-response for SMTP.

If the buffer passed to `smtp_endofresp()` isn't NUL terminated and contains
no character ending the parsed number, and `len` is set to 5, then the
`strtol()` call reads beyond the allocated buffer. The read contents will not
be returned to the caller.
```

The issue was reported to the project on 18 January 2019.
A patch was sent to me on 19 January 2019. 
curl 7.64.0 was released on 6 January 2019.

https://curl.haxx.se/docs/CVE-2019-3823.html

## Impact

If the buffer passed to `smtp_endofresp()` isn't NUL terminated and contains no character ending the parsed number, and `len` is set to 5, then the `strtol()` call reads beyond the allocated buffer.

## Attachments
No attachments
